- name: Install OpenJDK
  package:
    name: openjdk-8-jre
    state: present

- name: Add `Jenkins` repository
  apt_repository:
    repo: "deb http://pkg.jenkins.io/debian-stable binary/"
    state: present
    update_cache: yes

- name: Install packages
  package:
    name: openjdk-8-jre ec2-instance-connect nfs-common unzip jq pacemaker corosync awscli crmsh pcs
    state: present

- name: Create JENKINS_HOME

- name: Update Jenkins configs

- name: Restart Jenkins

- name: Create OCF Jenkins resource

- name: Create Corosync config template

- name: Disable Stonith

- name: Create /usr/bin/user_data.sh
  copy:
    src: user_data.sh
    dest: /usr/bin/user_data.sh
    owner: root
    group: root
    mode: '0755'
    backup: yes
